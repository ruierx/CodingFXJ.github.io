{
    "version": "https://jsonfeed.org/version/1",
    "title": "CodingFXJ'Blog • All posts by \"懒加载\" tag",
    "description": "",
    "home_page_url": "https://CodingFXJ.github.io",
    "items": [
        {
            "id": "https://codingfxj.github.io/2021/07/05/JS%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD/",
            "url": "https://codingfxj.github.io/2021/07/05/JS%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD/",
            "title": "JS图片懒加载",
            "date_published": "2021-07-05T10:08:41.000Z",
            "content_html": "<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\css\\APlayer.min.css\"><script src=\"\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\js\\Meting.min.js\"></script><p>主要思路：图片出现在可视区，让自定义属性 <code>data-src</code>  赋值给 <code>src</code>  显示图片</p>\n<h3 id=\"方案一\"><a class=\"markdownIt-Anchor\" href=\"#方案一\">#</a> 方案一</h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> images = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">&#x27;img&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">window</span>.addEventListener(<span class=\"string\">&#x27;scroll&#x27;</span>, <span class=\"function\">(<span class=\"params\">e</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    images.forEach(</span><br><span class=\"line\">        <span class=\"function\"><span class=\"params\">image</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> imageTop = image.getBoundingClientRect().top</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (imageTop &lt; <span class=\"built_in\">window</span>.innerHeight) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">const</span> data_src = image.getAttribute(<span class=\"string\">&#x27;data-src&#x27;</span>)</span><br><span class=\"line\">                image.setAttribute(<span class=\"string\">&#x27;src&#x27;</span>, data_src)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    )</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"方案二观察者\"><a class=\"markdownIt-Anchor\" href=\"#方案二观察者\">#</a> 方案二 (观察者)</h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> images = <span class=\"built_in\">document</span>.querySelectorAll(<span class=\"string\">&#x27;img&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> callback = <span class=\"function\"><span class=\"params\">enteries</span> =&gt;</span> &#123;</span><br><span class=\"line\">    enteries.forEach(<span class=\"function\"><span class=\"params\">entry</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (entry.isIntersecting) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> img = entry.target</span><br><span class=\"line\">            <span class=\"keyword\">const</span> data_src = img.getAttribute(<span class=\"string\">&#x27;data-src&#x27;</span>)</span><br><span class=\"line\">            img.setAttribute(<span class=\"string\">&#x27;src&#x27;</span>, data_src)</span><br><span class=\"line\">            observer.unobserve(img)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> observer = <span class=\"keyword\">new</span> IntersectionObserver(callback)</span><br><span class=\"line\">images.forEach(<span class=\"function\"><span class=\"params\">image</span> =&gt;</span> &#123;</span><br><span class=\"line\">    observer.observe(image)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "JS",
                "懒加载"
            ]
        }
    ]
}